<!DOCTYPE html>
<html lang="en">

<head><script src="/blog/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=blog/livereload" data-no-instant defer></script>
  
  <title>My PR check pipeline :: MemoriasIT</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="As someone who works in a consultancy firm, I create many projects. This process can be tedious and repetitive. That&#39;s why creating &#34;building blocks&#34; can be really helpful..." />
<meta name="keywords" content="MemoriasIT, memorias de un inform√°tico, programming, software" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="http://localhost:1313/blog/posts/20241029-prpipeline/" />


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-WSTDDX5THR"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-WSTDDX5THR');
        }
      </script>



  
  <link rel="stylesheet" href="http://localhost:1313/blog/css/buttons.min.2bc533403a27dfe0e93105a92502b42ce4587e2e4a87d9f7d349e51e16e09478.css">

  
  <link rel="stylesheet" href="http://localhost:1313/blog/css/code.min.00125962708925857e7b66dbc58391d55be1191a3d0ce2034de8c9cd2c481c36.css">

  
  <link rel="stylesheet" href="http://localhost:1313/blog/css/fonts.min.4881f0c525f3ce2a1864fb6e96676396cebe1e6fcef1933e8e1dde7041004fb5.css">

  
  <link rel="stylesheet" href="http://localhost:1313/blog/css/footer.min.03250fd07fc54d4a4a9e1fa9063b95c86bbd6fa675aad3b37fa47752d1740922.css">

  
  <link rel="stylesheet" href="http://localhost:1313/blog/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="http://localhost:1313/blog/css/header.min.fb6398822d04924d477c21b9721ae0bc72bd0299810df543cef1f78b4f701a51.css">

  
  <link rel="stylesheet" href="http://localhost:1313/blog/css/main.min.fe8dc560fccb53a458b0db19ccb7b265764ac46b68596b7e099c6793054dd457.css">

  
  <link rel="stylesheet" href="http://localhost:1313/blog/css/menu.min.83637a90d903026bc280d3f82f96ceb06c5fc72b7c1a8d686afb5bbf818a29f7.css">

  
  <link rel="stylesheet" href="http://localhost:1313/blog/css/pagination.min.82f6400eae7c7c6dc3c866733c2ec0579e4089608fea69400ff85b3880aa0d3c.css">

  
  <link rel="stylesheet" href="http://localhost:1313/blog/css/post.min.821588fdfc8229606f1f3c19742b2e39df64b0210a82cca371d6911b3150350f.css">

  
  <link rel="stylesheet" href="http://localhost:1313/blog/css/prism.min.9023bbc24533d09e97a51a0a42a5a7bfe4c591ae167c5551fb1d2191d11977c0.css">

  
  <link rel="stylesheet" href="http://localhost:1313/blog/css/syntax.min.cc789ed9377260d7949ea4c18781fc58959a89287210fe4edbff44ebfc1511b6.css">

  
  <link rel="stylesheet" href="http://localhost:1313/blog/css/terminal.min.fd3c401be0f1907a386e3a2a738d6448cd552d6c632822e9e36447e01d01a58b.css">

  
  <link rel="stylesheet" href="http://localhost:1313/blog/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">







<link rel="shortcut icon" href="http://localhost:1313/blog/favicon.png">
<link rel="apple-touch-icon" href="http://localhost:1313/blog/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="My PR check pipeline">
<meta property="og:description" content="As someone who works in a consultancy firm, I create many projects. This process can be tedious and repetitive. That&#39;s why creating &#34;building blocks&#34; can be really helpful..." />
<meta property="og:url" content="http://localhost:1313/blog/posts/20241029-prpipeline/" />
<meta property="og:site_name" content="" />

  <meta property="og:image" content="http://localhost:1313/blog/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2024-10-29 00:00:00 &#43;0000 UTC" />












</head>

<body>
  

  <div class="container center">

    <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/blog/"
  aria-label="Go to the homepage">
  <div class="logo">
    
    
    <img src="https://memoriasit.com/blog/logo.avif" alt="MemoriasIT" style="width: 180px; height: auto;">
  </div>
</a>
    </div>
    
    <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;‚ñæ</li>
  <li>
    <ul class="menu__dropdown">
      <li><a href="/">Home</a></li>
      <li><a href="/blog">Blog</a></li>
      <li><a href="/blog/about">About</a></li>
      
      
      <li><a href=""></a></li>
      
      
      
    </ul>
  </li>
</ul>
    
    
  </div>
  
  <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
    <li><a href="/">Home</a></li>
    <li><a href="/blog">Blog</a></li>
    <li><a href="/blog/about">About</a></li>
    
    
  </ul>
</nav>
  
</header>

    <div class="content">
      
<article class="post">
  <h1 class="post-title">
    <a href="http://localhost:1313/blog/posts/20241029-prpipeline/">My PR check pipeline</a>
  </h1>
  <div class="post-meta"><time class="post-date">2024-10-29</time><span class="post-author">memoriasIT</span></div>

  
  


  

  <div class="post-content"><div>
        <p>As someone who works in a consultancy firm, I create many projects. This process can be tedious and repetitive. That&rsquo;s why creating &ldquo;building blocks&rdquo; can be really helpful.</p>
<p>I believe this is specially true for the CI/CD of the applications.
In today&rsquo;s post, I would like to create the (my) &ldquo;perfect&rdquo; PR check pipeline for your github repo.</p>
<p>As a Flutter developer, I often find myself inspired by the work of VeryGoodVentures. Not only is it of great quality, but it is also MIT licensed. If you are familiar with <a href="https://www.github.com/VeryGoodOpenSource/very_good_workflows/tree/main">VeryGoodWorkflows</a>, this might feel familiar.</p>
<h1 id="lets-get-to-the-point">Let&rsquo;s get to the point!<a href="#lets-get-to-the-point" class="hanchor" ariaLabel="Anchor">#</a> </h1>
<p>Let&rsquo;s first make a list of all the requirements I would like my action to have:</p>
<ul>
<li><strong>Simple:</strong> Understanding the actions should not require a lot of knowledge.</li>
<li><strong>Reusable:</strong> There might be small differences between projects (architecture, versions, requirements, etc.). The actions should be flexible enough to account for that.</li>
<li><strong>Templates:</strong> Projects should not have to copy and paste the workflows from one project to another. This makes upgrading and modifying all workflows painful.</li>
</ul>
<h2 id="what-do-i-specifically-want-my-pr-workflow-to-do">What do I specifically want my PR workflow to do?<a href="#what-do-i-specifically-want-my-pr-workflow-to-do" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<ul>
<li>
<p><strong>Vulnerability Scanner:</strong> A couple of months ago, I discovered <a href="https://security.googleblog.com/2022/12/announcing-osv-scanner-vulnerability.html">OSV-scanner</a>. This scanner, made by Google, aggregates multiple vulnerability databases to find existing vulnerabilities affecting your project&rsquo;s dependencies. I actually made a blog post about it, <a href="/blog/posts/20241213-osvscanner/">check it out here!</a></p>
</li>
<li>
<p><strong>PR format:</strong> I would like to make sure that the PR titles follow the same style for future search/reference. One common style to use is the <a href="https://www.conventionalcommits.org/en/v1.0.0/">Conventional Commits</a> spec.</p>
</li>
<li>
<p><strong>Analysis:</strong> Either with dart static analysis or something like SonarCube. For simplicity I will use the default dart analysis. But I will probably tackle the implementation of SonarCube in the near future (I am intrigued by their <em>&ldquo;new&rdquo;</em> dart support).</p>
</li>
<li>
<p><strong>Tests:</strong> Testing is can be a great safety net for errors sometimes. Let&rsquo;s run tests and add support for minimum coverage required.</p>
</li>
<li>
<p><strong>Build:</strong> I feel like this could spark controversy, as a build can take considerable time. But, personally I would like to have the assurance that what is in develop/master can be built successfully.</p>
</li>
</ul>
<h2 id="the-full-workflow">The full workflow<a href="#the-full-workflow" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">name</span>: <span style="color:#ae81ff">pull-request-check</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Cancel the active runs of the same branch of the same workflow (run only one</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># at the same time)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">concurrency</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">group</span>: <span style="color:#ae81ff">${{ github.workflow }}-${{ github.ref }}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">cancel-in-progress</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">on</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">workflow_dispatch</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">inputs</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># Custom scopes for the semanticTitle job</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">scopes</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">required</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">type</span>: <span style="color:#ae81ff">string</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># Directories to analyze with flutter analyze</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">analyze_directories</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">required</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">type</span>: <span style="color:#ae81ff">string</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">default</span>: <span style="color:#e6db74">&#34;lib test&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># In multipackage projects the build directory might be different</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">working_directory</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">required</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">type</span>: <span style="color:#ae81ff">string</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">default</span>: <span style="color:#e6db74">&#34;.&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># Pre-run hook, useful to run custom commands before the build (e.g. melos get)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">setup</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">required</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">type</span>: <span style="color:#ae81ff">string</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">default</span>: <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># After-run hook, useful to run custom commands after the build</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">cleanUp</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">required</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">type</span>: <span style="color:#ae81ff">string</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">default</span>: <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># Git clone fetch-depth</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">fetchDepth</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">required</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">type</span>: <span style="color:#ae81ff">number</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">default</span>: <span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># Paths excluded from coverage</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">coverage_excludes</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">required</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">type</span>: <span style="color:#ae81ff">string</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">default</span>: <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># Minimum coverage required</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">min_coverage</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">required</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">type</span>: <span style="color:#ae81ff">number</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">default</span>: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Run workflow if pull request targets main/develop, master or a release branch.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">branches</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">main</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">develop</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">master</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#e6db74">&#34;release/**&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># It will run when the PR is opened, close &amp; reopened, set from draft to ready</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># to review, the title/body/base is changed or the head branch was updated.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">pull_request</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">types</span>: [<span style="color:#ae81ff">opened, reopened, ready_for_review, synchronize, edited]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Only read permission to contents and pull-requests is required, if you decide</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># to expand on this workflow you might need to add more permissions</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">permissions</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">pull-requests</span>: <span style="color:#ae81ff">read</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">contents</span>: <span style="color:#ae81ff">read</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">jobs</span>:
</span></span><span style="display:flex;"><span> <span style="color:#f92672">semanticTitle</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># By tagging the runner we can use multiple runners according to if we are</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># building for iOS (that requires Mac OS) or not. In this case, we don&#39;t care.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># This is a great way to save costs if you are not self-hosting.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># runs-on: [linux, macos]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># If you are using github images you can just pick one from their images here:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># https://github.com/actions/runner-images?tab=readme-ov-file#available-images</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">ubuntu-24.04</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">steps</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># feat(MIT-33): Add `Button` component</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ^    ^    ^</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># |    |    |__ Subject</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># |    |_______ Scope</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># |____________ Type</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ü§ñ Ensure Commit is Semantic</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">amannn/action-semantic-pull-request@0723387faaf9b38adef4775cd42cfd5155ed6017</span> <span style="color:#75715e"># v5.5.3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">env</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">GITHUB_TOKEN</span>: <span style="color:#ae81ff">${{ secrets.GITHUB_TOKEN }}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#75715e"># If PR is only a single commit we also check for the valid pattern</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">validateSingleCommit</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>          <span style="color:#75715e"># Scopes can be passed from the project itself. This will allow to</span>
</span></span><span style="display:flex;"><span>          <span style="color:#75715e"># have custom JIRA ticket numbers. For example: &#34;MIT-33&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">scopes</span>: <span style="color:#ae81ff">${{inputs.scopes}}</span>
</span></span><span style="display:flex;"><span>          <span style="color:#75715e"># If for some reason we want to skip the check in a PR we can add the</span>
</span></span><span style="display:flex;"><span>          <span style="color:#75715e"># label &#34;ignore-semantic-pull-request&#34; to it to skip the check.</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">ignoreLabels</span>: |<span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            ignore-semantic-pull-request</span>            
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># I wrote a post for this in more detail, check it out here:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># https://memoriasit.com/blog/posts/20241213-osvscanner/</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">vulnerability-checker</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ü¶†Ô∏èVulnerability check</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">ubuntu-24.04</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">steps</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Sets the SSH key to clone the repo</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">üîëSetup repo SSH key</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">shimataro/ssh-key-action@v2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">key</span>: <span style="color:#ae81ff">${{ secrets.SSH_KEY }}</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">known_hosts</span>: <span style="color:#ae81ff">${{ secrets.SSH_KNOWN_HOSTS }}</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">if_key_exists</span>: <span style="color:#ae81ff">ignore</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># Checks out (clones) the code repo</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">üìöCheckout code</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/checkout@v3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">ref</span>: <span style="color:#ae81ff">${{ github.head_ref }}</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">fetch-depth</span>: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Set up Go</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/setup-go@v2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">go-version</span>: <span style="color:#e6db74">&#34;1.23.3&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># Use OSV-Scanner to find known vulnerabilities in packages</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># This is not default in github runners if you use macOS just use brew (see my post for details)</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ü¶†Ô∏è Vulnerability Check</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">run</span>: |<span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          go install github.com/google/osv-scanner/cmd/osv-scanner@v1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          osv-scanner -lockfile=./pubspec.lock</span>          
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">build</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">üî® Build</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">defaults</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">run</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">working-directory</span>: <span style="color:#ae81ff">${{inputs.working_directory}}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">ubuntu-24.04</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">steps</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">üîëSetup repo SSH key</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">shimataro/ssh-key-action@v2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">key</span>: <span style="color:#ae81ff">${{ secrets.SSH_KEY }}</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">known_hosts</span>: <span style="color:#ae81ff">${{ secrets.SSH_KNOWN_HOSTS }}</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">if_key_exists</span>: <span style="color:#ae81ff">ignore</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">üìö Git Checkout</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/checkout@v4</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">ref</span>: <span style="color:#ae81ff">${{ github.head_ref }}</span>
</span></span><span style="display:flex;"><span>          <span style="color:#75715e"># By default only the last commit is fetched, but we will generate a</span>
</span></span><span style="display:flex;"><span>          <span style="color:#75715e"># changelog automatically, so this will be necessary.</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">fetch-depth</span>: <span style="color:#ae81ff">${{inputs.fetchDepth}}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">‚¨áÔ∏èInstall Flutter version used in the project</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># I use FVM, which is the flutter equivalent of NPM for JS or RVM for ruby.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># It uses a config file in the project to specify the version (.fvmrc).</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">fvm install</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ü§´ Set SSH Key</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">env</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">ssh_key</span>: <span style="color:#ae81ff">${{secrets.ssh_key}}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">if</span>: <span style="color:#ae81ff">env.ssh_key != null</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">webfactory/ssh-agent@v0.9.0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">ssh-private-key</span>: <span style="color:#ae81ff">${{secrets.ssh_key}}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">‚¨áÔ∏èGet Flutter dependencies</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">fvm flutter pub get</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">‚ö†Ô∏èAnalyze for lint errors/warnings</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">fvm flutter analyze</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">üß™Run tests</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">fvm flutter test --no-pub --coverage</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">üìä Check Code Coverage</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">VeryGoodOpenSource/very_good_coverage@v3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">path</span>: <span style="color:#ae81ff">${{inputs.working_directory}}/coverage/lcov.info</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">exclude</span>: <span style="color:#ae81ff">${{inputs.coverage_excludes}}</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">min_coverage</span>: <span style="color:#ae81ff">${{inputs.min_coverage}}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">‚¨áInstall bundle dependencies in Android</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">working-directory</span>: <span style="color:#ae81ff">${{inputs.working_directory}}/android</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">bundle install</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">‚öôÔ∏èBuild APK</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">working-directory</span>: <span style="color:#ae81ff">${{inputs.working_directory}}/android</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># In this PR check pipeline we are only worried about if the app builds,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># for that reason, I don&#39;t worry about flavors or any input</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">fvm flutter build apk</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># TODO JOB SUMMARY</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/workflow-commands-for-github-actions#adding-a-job-summary</span>
</span></span></code></pre></div><h2 id="how-to-use-this-workflow-in-your-project">How to use this workflow in your project?<a href="#how-to-use-this-workflow-in-your-project" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;Your project name&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">name</span>: <span style="color:#ae81ff">Reusable workflow</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">on</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">workflow_call</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">jobs</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">call-another-reusable</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">octo-org/example-repo/.github/workflows/another-reusable.yml@v1</span>
</span></span></code></pre></div><p><a href="https://docs.github.com/en/actions/sharing-automations/creating-workflow-templates-for-your-organization">https://docs.github.com/en/actions/sharing-automations/creating-workflow-templates-for-your-organization</a></p>

      </div></div>

  
    
<div class="pagination">
  <div class="pagination__title">
    <span class="pagination__title-h">Read other posts</span>
    <hr />
  </div>
  <div class="pagination__buttons">
    
      <a href="http://localhost:1313/blog/posts/20241213-osvscanner/" class="button inline prev">
        Scanning for vulnerabilities in your dependencies
      </a>
    
    
    
  </div>
</div>


  

  
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "memoriasit" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  
</article>

    </div>

    
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>¬© 2024 memoriasIT</a></span>
        
        <span>:: Theme made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
    </div>
</footer>






<script type="text/javascript" src="/blog/bundle.min.js"></script>




    
  </div>

</body>

</html>